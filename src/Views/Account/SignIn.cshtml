@using Microsoft.Owin.Security
@using Weavy.Web.Controllers
@model Weavy.Web.Models.SignInModel
@{
    Layout = "~/Views/Shared/_LayoutBasic.cshtml";
    Title = T["Sign in"].ToString();
}
<div class="container mt-5">
    <div class="row justify-content-sm-center">
        <div class="col-sm-8 col-md-6 col-lg-5">
            <div class="text-center mb-5">
                <img style="width: 100%;" src="~/img/horizontal dotcom blue-logo.png" />
            </div>

            <div id="appleid-signin" data-color="black" data-border="true" data-type="sign in" style="height: 46px; width: 220px; margin: auto; margin-bottom: 20px;"></div>

            <form action="@ConfigurationService.AppSetting("findparts-url")/Account/ExternalLoginFromBackChannel?path=@Model.Path" method="post" style="text-align: center;">
                <button type="submit" class="btn btn-primary" id="LinkedIn" name="provider" value="LinkedIn" title="Sign in with LinkedIn" style="margin: 10px; width: 220px;"><img src="~/img/linkedin.png" style="width: 30px; height:30px; border-radius: 4px;" />&nbsp;&nbsp; Sign In with LinkedIn</button>
            </form>
        </div>
    </div>
</div>

<script type="text/javascript" src="https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js"></script>
<script type="text/javascript">
        AppleID.auth.init({
            clientId: '@ConfigurationService.AppSetting("AppleAppId")',
            scope: 'name email',
            redirectURI: '@ConfigurationService.AppSetting("findparts-url")/apple-signin',
            state: 'backchannel',
            nonce: 'nonce',
            usePopup: false //or false defaults to false
        });       
</script>

@if (ViewData.ModelState.Values.SelectMany(x => x.Errors).Any())
{
    <script>
        $(function () {
            wvy.postal.postToParent({ name: "authentication-error" });
        })
    </script>
}
